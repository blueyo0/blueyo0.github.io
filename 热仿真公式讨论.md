# 前言
最近开始要做一些生物热仿真的相关工作，因此就针对相关的基础知识进行一些回顾。

以前有接触过一些工程传热学相关的东西，本来准备直接当成工程介质处理来着。后来仔细调研了一下发现，生物传热学有自己的Pennes等导热模型，因为所有活体组织内都有毛细血管、活动空洞等结构，不能一概而论地当成理想均匀介质。

所以单独开了这个专题，用来记录和分享一些生物传热学相关的内容，整体内容十分基础，可能更多的用于小白入门以及我个人的备忘录吧。

# 傅里叶传热定律
由于仿真过程主要的热交换方式为热传导，所以不可避免的需要重温导热公式——傅里叶传热定律（公式(1)）

$$\boldsymbol{q}=-k \nabla T \tag{1.1}$$

**含义**：热通量（热流密度）= 导热率 $\times$ 温度场负梯度

$$\boldsymbol{q}=Q/A \tag{1.2}$$

**含义**：热通量（热流密度）= 热量 $\div$ 导热面积

$$\nabla T=\vec{e}_{x} \frac{\partial T}{\partial x}+\vec{e}_{y} \frac{\partial T}{\partial y}+\vec{e}_{z} \frac{\partial T}{\partial z} \tag{1.3}$$

**含义**：温度场梯度 = 温度在x,y,z坐标上的偏导 $\times$ 对应单位向量 的和

$$\alpha = k/\rho c \tag{1.4}$$

**含义**：热扩散系数 = 导热率 $\div$ (密度 $\times$ 比热容)

热扩散系数是比导热率更直观的参数。导热率高的材料不一定一端升温，一端迅速升温，但热扩散系数高的材料一定会。

$$c = \frac{\partial Q}{\rho V \partial T} \tag{1.5}$$

**含义**：比热容 = 吸收的热量/(密度$\times$体积$\times$单位温度)



# 非稳态热传导[^1] 
热仿真过程中必然涉及到非稳态热传导(温度随时间不停变化时的热传导)，此时的温度场$T$从$T(x,y,z)$变为了$T(x,y,z,t)$，增加了一维时间。

## 一维非稳态
对温度场$T(x,t)$，导热公式如下：
$$\frac{\partial T}{\partial t}=\alpha \frac{\partial^{2} T}{\partial x^{2}} \tag{2.1}$$

在实际求解过程中，如果采用有限差分法(FDM)思路，在时间维度取向前差分，空间方向上的二阶偏导数取中间差分，以此来保持差分格式的稳定性：
$$
\frac{T(x_i,t_{j+1})-T(x_i,t_{j})}{\Delta t} = 
\alpha \frac{T(x_{i+1},t_j)+T(x_{i-1},t_j)-2T(x_{i},t_j)}{(\Delta x)^2} 
\tag{2.2}
$$
移项可得：
$$
T(x_i,t_{j+1}) = \alpha \Delta t \frac{T(x_{i+1},t_j)+T(x_{i-1},t_j)-2T(x_{i},t_j)}{(\Delta x)^2} + T(x_i,t_{j}) 
\tag{2.3}
$$

**含义**：对任意$x_i$位置，可由$t_j$时刻的温度迭代算出$t_{j+1}$时刻的温度

## 三维非稳态
从上面的推导可以看出，传热方程的解析解依赖对$\nabla T$的求解，所以存在对空间形状的依赖，只有一些特定形状的物体可以求解析解。

以圆柱体为例，原本有$T(x,y,z,t)$，可以利用空间对称性转换为一个四分之一圆的二维问题$T(x,y,t)$，或者再进一步可以转换为半径方向上的一维问题$T(r,t)$。

P.S. 只有半径相对于高而言很小的圆柱可以忽略z轴坐标产生的影响，因为可以被视作无限高圆柱处理）

# 仿真方法
传统的热仿真方法主要有：有限差分(FDM)、有限元(FEM)、边界元(BEM)

较新的方法包括：蒙特卡洛(MC)、边界点法

* FDM已经在上面展示过了，优点是简单易用，缺点是依赖于形状
* FEM是ANSYS等仿真软件使用的算法，优点是对形状适应性强，缺点是速度慢、难度大
* BEM和边界点没了解过，按论文里的介绍和FEM差不多
* MC依赖一个随机路径，优点是速度快、不依赖形状，缺点是只能算一个点、精度较低

# 小结
总的来说，热仿真问题的基础解决思路都在上面有所涉及；更前沿的仿真方法或者生物热传导的特有模型（如pennes之类的）将会在之后的文章中进行阐述。





[^1]: 许国良.工程传热学[M].中国电力出版社,2005.
